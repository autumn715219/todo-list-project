{"ast":null,"code":"import _regeneratorRuntime from\"/Users/Autumn_1/wehelp/@\\u7B2C\\u4E09\\u968E\\u6BB5/todo-list-project/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/Autumn_1/wehelp/@\\u7B2C\\u4E09\\u968E\\u6BB5/todo-list-project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/Users/Autumn_1/wehelp/@\\u7B2C\\u4E09\\u968E\\u6BB5/todo-list-project/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/Autumn_1/wehelp/@\\u7B2C\\u4E09\\u968E\\u6BB5/todo-list-project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./list.scss';import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{auth,db}from'../utils/firebase.js';import{signOut}from'firebase/auth';import{uid}from'uid';import{set,ref,onValue,remove}from'firebase/database';import AddIcon from'../assect/add.svg';import DeleteIcon from'../assect/delete.svg';// import LogoutIcon from '@mui/icons-material/Logout';\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function List(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),todo=_useState2[0],setTodo=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),todos=_useState4[0],setTodos=_useState4[1];var navigate=useNavigate();useEffect(function(){auth.onAuthStateChanged(function(user){if(user){// read\nonValue(ref(db,\"/\".concat(auth.currentUser.uid)),function(snapshot){setTodos([]);var data=snapshot.val();if(data!==null){Object.values(data).map(function(todo){setTodos(function(oldArray){return[].concat(_toConsumableArray(oldArray),[todo]);});});}});}else if(!user){navigate('/');}});},[]);var handleSignOut=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return signOut(auth).then(function(){navigate('/');}).catch(function(err){alert(err.message);});case 2:case\"end\":return _context.stop();}},_callee);}));return function handleSignOut(){return _ref.apply(this,arguments);};}();// add\nvar writeToDatabase=function writeToDatabase(){var uidd=uid();set(ref(db,\"/\".concat(auth.currentUser.uid,\"/\").concat(uidd)),{todo:todo,uidd:uidd});setTodo('');};// delete\nvar handleDelete=function handleDelete(uid){remove(ref(db,\"/\".concat(auth.currentUser.uid,\"/\").concat(uid)));};return/*#__PURE__*/_jsx(\"div\",{className:\"WRAPPER\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"list\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Todo List\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"add todo...\",value:todo,onChange:function onChange(e){return setTodo(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn_add\",onClick:writeToDatabase,children:/*#__PURE__*/_jsx(\"img\",{src:AddIcon})}),todos.map(function(todo,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"todo\",children:[/*#__PURE__*/_jsx(\"h2\",{children:todo.todo}),/*#__PURE__*/_jsx(\"button\",{className:\"btn_delete\",onClick:function onClick(){return handleDelete(todo.uidd);},children:/*#__PURE__*/_jsx(\"img\",{src:DeleteIcon})})]},index);}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSignOut,children:\"\\u767B\\u51FA\"})]})});}","map":{"version":3,"names":["React","useState","useEffect","useNavigate","auth","db","signOut","uid","set","ref","onValue","remove","AddIcon","DeleteIcon","List","todo","setTodo","todos","setTodos","navigate","onAuthStateChanged","user","currentUser","snapshot","data","val","Object","values","map","oldArray","handleSignOut","then","catch","err","alert","message","writeToDatabase","uidd","handleDelete","e","target","value","index"],"sources":["/Users/Autumn_1/wehelp/@第三階段/todo-list-project/src/components/List.js"],"sourcesContent":["import './list.scss';\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { auth, db } from '../utils/firebase.js';\nimport { signOut } from 'firebase/auth';\nimport { uid } from 'uid';\nimport { set, ref, onValue, remove } from 'firebase/database';\n\nimport AddIcon from '../assect/add.svg';\nimport DeleteIcon from '../assect/delete.svg';\n// import LogoutIcon from '@mui/icons-material/Logout';\n\nexport default function List() {\n  const [todo, setTodo] = useState('');\n  const [todos, setTodos] = useState([]);\n  const navigate = useNavigate();\n  useEffect(() => {\n    auth.onAuthStateChanged((user) => {\n      if (user) {\n        // read\n        onValue(ref(db, `/${auth.currentUser.uid}`), (snapshot) => {\n          setTodos([]);\n          const data = snapshot.val();\n          if (data !== null) {\n            Object.values(data).map((todo) => {\n              setTodos((oldArray) => [...oldArray, todo]);\n            });\n          }\n        });\n      } else if (!user) {\n        navigate('/');\n      }\n    });\n  }, []);\n  const handleSignOut = async () => {\n    await signOut(auth)\n      .then(() => {\n        navigate('/');\n      })\n      .catch((err) => {\n        alert(err.message);\n      });\n  };\n\n  // add\n  const writeToDatabase = () => {\n    const uidd = uid();\n    set(ref(db, `/${auth.currentUser.uid}/${uidd}`), {\n      todo: todo,\n      uidd: uidd,\n    });\n    setTodo('');\n  };\n\n  // delete\n  const handleDelete = (uid) => {\n    remove(ref(db, `/${auth.currentUser.uid}/${uid}`));\n  };\n\n  return (\n    <div className='WRAPPER'>\n      <div className='list'>\n        <h1>Todo List</h1>\n        <input\n          type='text'\n          placeholder='add todo...'\n          value={todo}\n          onChange={(e) => setTodo(e.target.value)}\n        />\n        <button className='btn_add' onClick={writeToDatabase}>\n          <img src={AddIcon} />\n        </button>\n        {todos.map((todo, index) => (\n          <div className='todo' key={index}>\n            <h2>{todo.todo}</h2>\n            <button className='btn_delete' onClick={() => handleDelete(todo.uidd)}>\n              <img src={DeleteIcon} />\n            </button>\n          </div>\n        ))}\n\n        <button onClick={handleSignOut}>登出</button>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}